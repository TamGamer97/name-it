<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
</head>
<body>
    <h1 style="color: #8D65FF; text-align: center; font-size: 70px" >NAME IT!</h1>

    <h1 id="stats" style="color: #8D65FF; text-align: center; font-size: 20px; position: absolute; right: 100px; top: 50px;" ></h1>


    <div style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">

        <div id="cont" style="width: 650px; height: 350px; transition: 1s; display: flex; justify-content: center; align-items: center; flex-direction: column;">
            <!-- <h1 style="text-align: center; transition: 1s; position: absolute; font-size: 45px; margin-bottom: 50px;"> <span style="color: #5A33C8;">Quote 1:</span> <span style="color: #8D65FF;">"Hello"</span></h1> -->
            <!-- <h1 style="text-align: center; transition: 1s; position: absolute; font-size: 40px;"> <span style="color: #5A33C8;">Quote 1:</span> <span style="color: #8D65FF;">"Hello"</span></h1>
            <h1 style="text-align: center; transition: 1s; position: absolute; font-size: 35px;"> <span style="color: #5A33C8;">Quote 1:</span> <span style="color: #8D65FF;">"Hello"</span></h1>
            <h1 style="text-align: center; transition: 1s; position: absolute; font-size: 30px;"> <span style="color: #5A33C8;">Quote 1:</span> <span style="color: #8D65FF;">"Hello"</span></h1> -->
    
        </div>

        <img src="" id="MovieImg" style="width: 550px; display: none;">

        <div style="width: 100%; height: 150px; position: absolute; bottom: 30px; display: flex; justify-content: center; flex-direction: column; align-items: center;">

            <div id="gameInpts" style="display: flex; justify-content: center; flex-direction: column; align-items: center;">
                <div id="hintBtn" onclick="nextHint()" class="btn" style="width: 100px; height: 50px; border-radius: 20px; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: 1s; display: none;">
                    <h1 class="btnTxt" style="font-size: 20px; text-align: center; height: 100%; width: 100%; padding-top: 20px; transition: 1s;">Hint</h1>
                </div>
    
                <div style=" display: flex; flex-direction: row; gap: 10px; margin-top: 20px;">
                    <input list="movies" id="movie" type="text" placeholder="Guess a movie..." style="border: none; outline: none; border-radius: 20px; background-color: #262E4A; width: 450px; height: 45px; padding-left: 20px; color: #5A33C8; font-size: 20px;">
                    <datalist id="movies"></datalist>
    
                    <div onclick="guessMovie()" class="btn" id="guessBtn" style="width: 100px; height: 50px; border-radius: 20px; transition: 1s; cursor: pointer; ">
                        <h1 class="btnTxt" style="font-size: 20px; text-align: center; transition: 1s;">Guess</h1>
                    </div>
                    <div onclick="location.reload()" class="btn" style="width: 100px; height: 50px; border-radius: 20px; transition: 1s; cursor: pointer; display: none;">
                        <h1 class="btnTxt" style="font-size: 20px; text-align: center; height: 100%; width: 100%; transition: 1s; padding-bottom: 20px;">Skip</h1>
                    </div>
                </div>
    
                <h1 id="guessRemaining" style="font-size: 20px; color: #5A33C8; opacity: 0.7; text-align: center; height: 100%; width: 100%; transition: 1s;">4 Guesses Left</h1>
                <h1 id="incorrectGuess" style="font-size: 20px; color: #5A33C8; opacity: 0.7; text-align: center; height: 100%; width: 100%; transition: 1s; margin-top: -10px; margin-bottom: -20px;"></h1>

            </div>

            <div id="resultsInpts" style="display: none; justify-content: center; flex-direction: column; align-items: center;">
                <h1 id="movieName" style="font-size: 30px; color: #5A33C8; text-align: center; height: 100%; width: 100%; transition: 1s;">Movie Name</h1>

                <div onclick="location.reload()" class="btn" style="width: 150px; height: 50px; border-radius: 20px; display: none; justify-content: center; align-items: center; cursor: pointer; transition: 1s;">
                    <h1 class="btnTxt" style=" font-size: 20px; text-align: center; height: 100%; width: 100%; padding-top: 20px; transition: 1s;">Next Game</h1>
                </div>

            </div>


        </div>

    </div>
    
</body>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
<script>

    var movieData = []

    function loadStats()
    {
        var played = Cookies.get('played')
        var wins = Cookies.get('wins')

        if(!played)
        {
            Cookies.set('played', 0)
            played = 0
        }
        if(!wins)
        {
            Cookies.set('wins', 0)   
            wins = 0
        }

        document.getElementById('stats').innerHTML = 'Played: '+played+' <br> Wins: ' + wins
    }
    loadStats()

    function loadRandomGame()
    {
        fetch('moviesDatabase.json')
        .then(response => {
            if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            console.log(data);


            const randomIndx = (Math.floor(Math.random() * data.length))
            movieData = data[randomIndx]

            document.getElementById('MovieImg').src = movieData.ImageURL
            document.getElementById('movieName').innerHTML = movieData.Name

            nextHint()
            // Do something with your data
        })
    }
    loadRandomGame()

    function loadMoviesSuggestions()
    {
        var movies = []
        fetch('moviesList.json')
        .then(response => {
            if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            
            movies = data
            
            const datalist = document.getElementById('movies');
    
            movies.forEach(movie => {
                const option = document.createElement('option');
                option.value = movie;
                datalist.appendChild(option);
            });
        })


    }
    loadMoviesSuggestions()

    var hintCount = 0
    function nextHint()
    {
        const container = document.getElementById('cont').children
        var lastFontSize = '50px';

        hintCount ++

        for (n in container)
        {
            try{

                const textElem = container[n]
                console.log(textElem.style.marginBottom)
                const newBottomMargin = (parseInt((textElem.style.marginBottom).split('px')[0])) + 100
                console.log(newBottomMargin)
                textElem.style.marginBottom = newBottomMargin + 'px'
                
                lastFontSize = textElem.style.fontSize
            }catch{

            }
        }
        const newHintTxt = document.createElement('h1')
        if(hintCount == 4)
        {
            newHintTxt.style = "text-align: center; transition: 1s; position: absolute; opacity: 0; font-size: 45px; margin-bottom: 00px;"
            newHintTxt.innerHTML = ' <span style="color: #5A33C8;">Actor/Actress:</span> <span style="color: #8D65FF;">"'+movieData['Actor/Actress']+'"</span>'
            document.getElementById('cont').appendChild(newHintTxt)

            document.getElementById('hintBtn').style.opacity = 0.7
            document.getElementById('hintBtn').onclick = ''

        }else{

            newHintTxt.style = "text-align: center; transition: 1s; position: absolute; opacity: 0; font-size: 45px; margin-bottom: 00px;"
            newHintTxt.innerHTML = ' <span style="color: #5A33C8;">Quote '+hintCount+':</span> <span style="color: #8D65FF;">"'+movieData['Quote'+JSON.stringify(hintCount)]+'"</span>'
            document.getElementById('cont').appendChild(newHintTxt)
        }
        
        setTimeout(() => {
            newHintTxt.style.opacity = 1
            newHintTxt.style.marginBottom = '50px'
            newHintTxt.style.fontSize = ((parseInt((lastFontSize).split('px')[0])) - 5) + 'px'
        },10 )

    }

    var guessesLeft = 4
    function guessMovie()
    {
        const guessName = document.getElementById('movie').value

        if(guessName == '')
        {
            return
        }

        guessesLeft -= 1

        if(guessName == movieData['Name'])
        {
            winGame()
        }
        else if(guessesLeft == 0)
        {
            loseGame()
        }else{
            // incorrect guess but stil has chances left
            nextHint()
            document.getElementById('movie').value = ''

            document.getElementById('guessBtn').style.backgroundColor = '#a8323c'
            document.getElementById('guessBtn').children[0].style.color = 'white'
            document.getElementById('guessRemaining').style.opacity = 1
            document.getElementById('guessRemaining').style.color = '#6c45d9'
            document.getElementById('guessRemaining').style.fontSize = '22px'

            setTimeout(() => {
                document.getElementById('guessBtn').style.backgroundColor = '#262E4A'
                document.getElementById('guessBtn').children[0].style.color = '#5A33C8'
                document.getElementById('guessRemaining').style.opacity = 0.7
                document.getElementById('guessRemaining').style.color = '#5A33C8'
                document.getElementById('guessRemaining').style.fontSize = '20px'
            }, 500);


            if(guessesLeft == 3)
            {

                document.getElementById('incorrectGuess').innerHTML = '<span style="text-decoration-line: underline; text-decoration-color: #a8323c;">'+guessName+'</span>' 
            }else{
                document.getElementById('incorrectGuess').innerHTML = document.getElementById('incorrectGuess').innerHTML + ', <span style="text-decoration-line: underline; text-decoration-color: #a8323c;">'+guessName+'</span>' 

            }
        }
        


        document.getElementById('guessRemaining').innerHTML = guessesLeft + ' Guesses Left'
    }
    
    function winGame()
    {
        console.log('Correct')

        const played = Cookies.get('played')
        const wins = Cookies.get('wins')

        Cookies.set('played', JSON.parse(played) + 1)
        Cookies.set('wins', JSON.parse(wins) + 1)

        document.getElementById('gameInpts').style.display = 'none'
        document.getElementById('resultsInpts').style.display = 'flex'

        document.getElementById('cont').style.display = 'none'
        document.getElementById('MovieImg').style.display = 'flex'
    }

    function loseGame()
    {
        console.log('Wrong')

        const played = Cookies.get('played')

        Cookies.set('played', JSON.parse(played) + 1)

        document.getElementById('gameInpts').style.display = 'none'
        document.getElementById('resultsInpts').style.display = 'flex'

        document.getElementById('cont').style.display = 'none'
        document.getElementById('MovieImg').style.display = 'flex'
    }

</script>
</html>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap');

    body{
        background-color: #262B3C;

        font-family: "Jost", sans-serif;
        font-optical-sizing: auto;
        font-weight: bolder;
        font-style: normal;
    }

    ::placeholder {
        color: #5A33C8;
        font-weight: bold;
    }

    .btn{
        background-color: #262E4A;
    }

    .btnTxt{
        color: #5A33C8;
    }

    .btn:hover{
        background-color: #5A33C8;

        .btnTxt{
            color: #262E4A;
        }
    }
    
</style>