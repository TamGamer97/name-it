<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
</head>
<body>
    <h1 style="background-image: -webkit-gradient(
        linear,
        left top,
        right top,
        color-stop(0.03, #8D65FF),
        color-stop(0.76, #083471),
        color-stop(0.99, #340871)
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent; text-align: center; font-size: 70px;-webkit-text-stroke-width: 1px;
        -webkit-text-stroke-color: yellow; margin-top: 70px; " >NAME IT!</h1>

    <h1 id="stats" class="stats" style="color: #8D65FF; text-align: center; font-size: 20px; position: absolute; right: 100px; top: 50px;" ></h1>

    <img src="/infoIcon.png" id="infoIcon" onclick="document.getElementById('infoCont').style.display = 'flex'" class="infoBtn" style="position: absolute; right: 100px; width: 50px; top: 130px;">
    
    <div id="infoCont" style="position: absolute; top: 0px; left: 0px; height: 100%; width: 100%; background-color: rgba(36, 30, 36, 0.396); z-index: 10000; display: none; justify-content: center; align-items: center;">
        <div style="width: 75%; border-radius: 20px; height: 70%; position: relative; display: flex; justify-content: center; background-color: #262B3C; overflow-y: scroll;">
            <h1 style="color: #8D65FF; text-align: center; width: 90%;">Welcome to Name It! The Movie Quote Game. <br>
                
                <span style="font-size: 20px;">
                    Guess the movie from the quotes / hints given! <br> <br>
                    1.	There will be a total of 4 hints, the first 3 are quotes and a bonus hint, if needed, is a random actor/actress from the movie. <br>
                    2.	An incorrect answer or no guess will move to the next hint. Use the arrow buttons to cycle through previous hints. <br>
                    3.	Game will reset daily with a different movie to play each day. <br>
                </span>
                <span style="font-size: 23px; ">
                    <br>
                    Any feedback? Let me know at <a href="mailto:nameitthemoviequotegame@gmail.com" >nameitthemoviequotegame@gmail.com</a>
                </span>
                
            </h1>
            <h1 onclick="closeInfo()" style="position: absolute; top: -10px; right: 20px; color: white; cursor: pointer;">X</h1>
        </div>
    </div>


    <div style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
        
        <div id="divSec" style="width: 100%; height: 55%; top: 250px;position: absolute; display: flex; justify-content: center; flex-direction: column; align-items: center;">
            
            <div id="arrowCont" style="position: absolute; width: 500px; height: 200px; display: flex; justify-content: center; align-items: center; flex-direction: column; bottom: 180px;">
                <h1 class="arrow" id="arrow1" onclick="cycleHints('up')" style=" z-index: 1000; transition: 1s;">&uarr;</h1>
                <div id="arrowPadding" style="width: 200px; padding: 0px; transition: 1s;"></div>
                <h1 class="arrow" id="arrow2" onclick="cycleHints('down')" style=" z-index: 1000; transition: 1s;">&darr;</h1>
            </div>
            
            <div id="cont" style="width: 100%; height: 350px; transition: 1s; display: flex; justify-content: center; align-items: center; flex-direction: column; position: absolute; font-size: 22px; bottom: 90px;">
                <!-- Content of the 'cont' div remains unchanged -->
            </div>

            <div id="gameInpts" style="display: flex; justify-content: center; flex-direction: column; align-items: center;">
                <div id="hintBtn" onclick="nextHint()" class="btn" style="width: 100px; height: 50px; border-radius: 20px; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: 1s; display: none;">
                    <h1 class="btnTxt" style="font-size: 20px; text-align: center; height: 100%; width: 100%; padding-top: 20px; transition: 1s;">Hint</h1>
                </div>
    
                <div style=" display: flex; flex-direction: row; gap: 10px; margin-top: 300px;">
                    <div class="input-container" id="input-container">
                        <input list="movies" id="movie" class="movieInp" type="text" autocomplete="off" placeholder="Guess a movie..." style="border: none; outline: none; border-radius: 20px; width: 450px; background-color: #262E4A; height: 45px; padding-left: 20px; color: #5A33C8; font-size: 20px;">
                        <ul id="suggestions" class="suggestions-list"></ul>
                    </div>

                    <div onclick="guessMovie()" class="btn" id="guessBtn" style="width: 100px; height: 50px; border-radius: 20px; transition: 1s; cursor: pointer; margin-left: 20px; ">
                        <h1 class="btnTxt" style="font-size: 20px; text-align: center; transition: 1s;">Guess</h1>
                    </div>
                    <div onclick="location.reload()" class="btn" style="width: 100px; height: 50px; border-radius: 20px; transition: 1s; cursor: pointer; display: none;">
                        <h1 class="btnTxt" style="font-size: 20px; text-align: center; height: 100%; width: 100%; transition: 1s; padding-bottom: 20px;">Skip</h1>
                    </div>
                </div>
    
                <h1 id="guessRemaining" style="font-size: 20px; color: #5A33C8; opacity: 0.7; text-align: center; height: 100%; width: 100%; transition: 1s;">4 Guesses Left</h1>
                <h1 id="incorrectGuess" style="font-size: 20px; color: #5A33C8; opacity: 0.7; text-align: center; height: 100%; width: 100%; transition: 1s; margin-top: -10px; margin-bottom: -20px;"></h1>

            </div>

            <div id="resultsInpts" style="display: none; justify-content: center; flex-direction: column; align-items: center;">
                <h1 id="movieName" style="font-size: 30px; color: #5A33C8; text-align: center; height: 100%; width: 100%; transition: 1s;">Movie Name</h1>


                <img src="" id="MovieImg" style="width: 550px; display: none;">


                <div onclick="location.reload()" class="btn" style="width: 150px; height: 50px; border-radius: 20px; display: none; justify-content: center; align-items: center; cursor: pointer; transition: 1s;">
                    <h1 class="btnTxt" style=" font-size: 20px; text-align: center; height: 100%; width: 100%; padding-top: 20px; transition: 1s;">Next Game</h1>
                </div>

            </div>


        </div>

    </div>
    
</body>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
<script>

    // - Search bar not selectable after first 2 options and not able to scroll
    // Arrow spacing issues, they show up in the middle of the quotes/hints.

    var movieData = []

    var wordIndex;

    function closeInfo()
    {
        document.getElementById('infoCont').style.display = 'none'
    }

    function loadStats()
    {
        var played = Cookies.get('played')
        var wins = Cookies.get('wins')

        if(!played)
        {
            Cookies.set('played', 0)
            played = 0
        }
        if(!wins)
        {
            Cookies.set('wins', 0)   
            wins = 0
        }

        document.getElementById('stats').innerHTML = 'Played: '+played+' <br> Wins: ' + wins
    }
    loadStats()

    function loadRandomGame()
    {
        fetch('moviesDatabase.json')
        .then(response => {
            if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            console.log(data);

            
            function getWordOfTheDay() {
                const startDate = new Date('2023-08-02'); // Start date for the word list cycle
                const today = new Date();
                const diffDays = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
                const wordIndexCalc = diffDays % data.length;
                return wordIndexCalc
            }
            
            wordIndex = getWordOfTheDay()
            // const randomIndx = (Math.floor(Math.random() * data.length))
            movieData = data[wordIndex]

            document.getElementById('MovieImg').src = movieData.ImageURL
            document.getElementById('movieName').innerHTML = movieData.Name
            
            const wi = Cookies.get('wordIndex')
            console.log('wordIndex')
            console.log(wordIndex)
            if(wi != undefined)
            {
                if(wi == wordIndex)
                {
                    loseGame('noCookies')
                    return   
                }
            }




            nextHint()
            // Do something with your data
        })
    }
    loadRandomGame()

    function loadMoviesSuggestions()
    {
        var movies = []
        fetch('moviesList.json')
        .then(response => {
            if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            
            movies = data
            
            // const datalist = document.getElementById('movies');
    
            // movies.forEach(movie => {
            //     const option = document.createElement('option');
            //     option.value = movie;
            //     datalist.appendChild(option);
            // });

            const searchInput = document.getElementById('movie');
            const suggestionsList = document.getElementById('suggestions');

            // const suggestions = ['apple', 'banana', 'orange', 'grape', 'mango', 'pear'];
            const suggestions = movies

            searchInput.addEventListener('input', () => {
                const inputValue = searchInput.value.toLowerCase();
                suggestionsList.innerHTML = '';
                
                if (inputValue) {
                    const filteredSuggestions = suggestions.filter(item => item.toLowerCase().includes(inputValue));
                    
                    filteredSuggestions.forEach(suggestion => {
                        const li = document.createElement('li');
                        li.textContent = suggestion;
                        li.addEventListener('click', () => {
                            searchInput.value = suggestion;
                            suggestionsList.innerHTML = '';
                            suggestionsList.style.display = 'none';
                        });
                        suggestionsList.appendChild(li);
                    });
                    
                    if (filteredSuggestions.length > 0) {
                        suggestionsList.style.display = 'block';
                    } else {
                        suggestionsList.style.display = 'none';
                    }
                } else {
                    suggestionsList.style.display = 'none';
                }
            });

            document.addEventListener('click', (event) => {
                if (!event.target.closest('.input-container')) {
                    suggestionsList.style.display = 'none';
                }
            });
        })


    }
    loadMoviesSuggestions()

    var hintCount = 0
    var arrowGapSize = 20

    function nextHint()
    {
        const container = document.getElementById('cont').children
        var lastFontSize = '50px';

        if(currentHintView < hintCount)
        {
            var n = 0
            while (n <= hintCount - currentHintView)
            {
                cycleHints('down')
                n++
            }   
        }

        hintCount ++
        currentHintView ++

        for (n in container)
        {
            try{

                const textElem = container[n]
                console.log(textElem.style.marginBottom)
                const newBottomMargin = (parseInt((textElem.style.marginBottom).split('px')[0])) + 100
                console.log(newBottomMargin)
                textElem.style.marginBottom = newBottomMargin + 'px'
                textElem.style.opacity = 0
                
                lastFontSize = textElem.style.fontSize
            }catch{

            }
        }
        const newHintTxt = document.createElement('h1')
        if(hintCount == 4)
        {
            newHintTxt.style = "text-align: center; transition: 1s; position: absolute; opacity: 0; margin-bottom: 00px;"
            newHintTxt.innerHTML = ' <span style="color: #5A33C8;">Bonus Hint (Actor/Actress):</span> <span style="color: #8D65FF;">"'+movieData['Actor/Actress']+'"</span>'
            document.getElementById('cont').appendChild(newHintTxt)

            document.getElementById('hintBtn').style.opacity = 0.7
            document.getElementById('hintBtn').onclick = ''

        }else{

            newHintTxt.style = "text-align: center; transition: 1s; position: absolute; opacity: 0; margin-bottom: 0px; width: 100vw"
            newHintTxt.innerHTML = ' <span style="color: #5A33C8;">Quote '+hintCount+':</span> <span style="color: #8D65FF;">"'+movieData['Quote'+JSON.stringify(hintCount)]+'"</span>'
            
            // if(movieData['Quote'+JSON.stringify(hintCount)].length > 15)
            // {
            //     newHintTxt.style.fontSize = '1.3em'                
            // }
            document.getElementById('cont').appendChild(newHintTxt)

        }
        
        newHintTxt.style.fontSize = window.innerWidth * 0.035 + 'px'
        if(newHintTxt.style.fontSize.split('px')[0] > 35.98)
        {
            newHintTxt.style.fontSize = 35.98 + 'px'
        }
        
        // var count = newHintTxt.length + newHintTxt.value.replace(/[^\n]/g, '').length;
        // console.log(count)
        const oneLineHeight = 1.44
        const lineHeight = (newHintTxt.children[1].getBoundingClientRect().height / (window.innerWidth * 0.035)).toFixed(2)
        
        console.log('lines: ' + lineHeight/oneLineHeight)

        // newHintTxt.style.fontSize = ((JSON.parse(newHintTxt.style.fontSize.split('px')[0])) * (0.9/(lineHeight/oneLineHeight))) + 'px'


        document.getElementById('arrowPadding').style.padding = (arrowGapSize * lineHeight/oneLineHeight) + 'px'
        setTimeout(() => {
            newHintTxt.style.opacity = 1
            newHintTxt.style.marginBottom = '50px'
            // newHintTxt.style.fontSize = ((parseInt((lastFontSize).split('px')[0])) - 5) + 'px'
        },10 )

    }

    var guessesLeft = 4
    function guessMovie()
    {
        const guessName = document.getElementById('movie').value

        guessesLeft -= 1

        if(guessName == movieData['Name'])
        {
            winGame()
        }
        else if(guessesLeft == 0)
        {
            loseGame()
        }else{
            // incorrect guess but stil has chances left
            nextHint()
            document.getElementById('movie').value = ''

            document.getElementById('guessBtn').style.backgroundColor = '#a8323c'
            document.getElementById('guessBtn').children[0].style.color = 'white'
            document.getElementById('guessRemaining').style.opacity = 1
            document.getElementById('guessRemaining').style.color = '#6c45d9'
            document.getElementById('guessRemaining').style.fontSize = '22px'

            setTimeout(() => {
                document.getElementById('guessBtn').style.backgroundColor = '#262E4A'
                document.getElementById('guessBtn').children[0].style.color = '#5A33C8'
                document.getElementById('guessRemaining').style.opacity = 0.7
                document.getElementById('guessRemaining').style.color = '#5A33C8'
                document.getElementById('guessRemaining').style.fontSize = '20px'
            }, 500);


            if(guessName != '')
            {

                if(guessesLeft == 3)
                {
    
                    document.getElementById('incorrectGuess').innerHTML = '<span style="text-decoration-line: underline; text-decoration-color: #a8323c;">'+guessName+'</span>' 
                }else{
                    document.getElementById('incorrectGuess').innerHTML = document.getElementById('incorrectGuess').innerHTML + ', <span style="text-decoration-line: underline; text-decoration-color: #a8323c;">'+guessName+'</span>' 
    
                }
            }
        }
        


        document.getElementById('guessRemaining').innerHTML = guessesLeft + ' Guesses Left'
    }
    
    function winGame()
    {
        console.log('Correct')

        console.log('setting wi to ' + wordIndex)
        Cookies.set('wordIndex', wordIndex)

        const played = Cookies.get('played')
        const wins = Cookies.get('wins')

        Cookies.set('played', JSON.parse(played) + 1)
        Cookies.set('wins', JSON.parse(wins) + 1)

        document.getElementById('gameInpts').style.display = 'none'
        document.getElementById('resultsInpts').style.display = 'flex'

        document.getElementById('cont').style.display = 'none'
        document.getElementById('MovieImg').style.display = 'flex'

        document.getElementById('arrow1').style.visibility = 'hidden'
        document.getElementById('arrow2').style.visibility = 'hidden'

        document.getElementById('divSec').style.top = '0px'
    }

    function loseGame(noCookies)
    {
        console.log('setting wi to ' + wordIndex)
        Cookies.set('wordIndex', wordIndex)
        const played = Cookies.get('played')
        if(!noCookies)
        {
            console.log('Wrong')
            Cookies.set('played', JSON.parse(played) + 1)
        }

        document.getElementById('gameInpts').style.display = 'none'
        document.getElementById('resultsInpts').style.display = 'flex'

        document.getElementById('cont').style.display = 'none'
        document.getElementById('MovieImg').style.display = 'flex'

        document.getElementById('arrow1').style.visibility = 'hidden'
        document.getElementById('arrow2').style.visibility = 'hidden'

        document.getElementById('divSec').style.top = '0px'
    }

    var currentHintView = 0
    function cycleHints(direction)
    {
        if(direction == 'up')
        {
            if(currentHintView == 1)
            {
                return
            }

            currentHintView -= 1
            const container = document.getElementById('cont').children
            var lastFontSize = '50px';
    
            for (n in container)
            {
                try{
    
                    const textElem = container[n]
                    console.log(textElem.style.marginBottom)
                    const newBottomMargin = (parseInt((textElem.style.marginBottom).split('px')[0])) - 100
                    console.log(newBottomMargin)
                    textElem.style.marginBottom = newBottomMargin + 'px'
                    textElem.style.opacity = 0
                    
                    lastFontSize = textElem.style.fontSize
                }catch{
    
                }
            }

            console.log(container)
            console.log(currentHintView)
            console.log(container[currentHintView-1].style.opacity = 1)

        }
        if(direction == 'down')
        {
            if(hintCount <= currentHintView)
            {
                return
            }

            currentHintView += 1
            const container = document.getElementById('cont').children
            var lastFontSize = '50px';
    
            for (n in container)
            {
                try{
    
                    const textElem = container[n]
                    console.log(textElem.style.marginBottom)
                    const newBottomMargin = (parseInt((textElem.style.marginBottom).split('px')[0])) + 100
                    console.log(newBottomMargin)
                    textElem.style.marginBottom = newBottomMargin + 'px'
                    textElem.style.opacity = 0
                    
                    lastFontSize = textElem.style.fontSize
                }catch{
    
                }
            }

            console.log(container)
            console.log(currentHintView)
            console.log(container[currentHintView-1].style.opacity = 1)
        }
    }

    window.addEventListener('resize', resizeElements)

    function resizeElements()
    {
        console.log('resize')
        if(window.innerWidth < 700)
        {
            console.log('Shrink')
            document.getElementById('input-container').style.width = '300px'
            document.getElementById('movie').style.width = '300px'
            
            document.getElementById('stats').style.top = '0px'
            document.getElementById('stats').style.right = '10px'
            
            document.getElementById('infoIcon').style.top = '10px'
        }

        if(window.innerWidth < 500)
        {
            console.log('Shrink again')
            document.getElementById('input-container').style.width = '230px'
            document.getElementById('movie').style.width = '230px'
            
            document.getElementById('stats').style.top = '0px'
            document.getElementById('stats').style.right = '10px'
            
            document.getElementById('infoIcon').style.top = '10px'

            document.getElementById('cont').style.fontSize= '18px   '
        }

        // if(window.innerWidth > window.innerHeight && window.innerHeight < 350)
        // {
        //     console.log('extra space')

        //     // document.getElementById('cont').style.marginTop = '50px'

        //     document.getElementById('arrow1').style.marginTop = '100px'
        // }


        if(window.innerHeight < 550)
        {
            document.getElementById('arrowCont').style.bottom = '70px'
            document.getElementById('cont').style.bottom = '-20px'

            arrowGapSize = 10
        }
        if(window.innerHeight > 550)
        {
            document.getElementById('arrowCont').style.bottom = '180px'
            document.getElementById('cont').style.bottom = '90px'
        }
    }

    resizeElements()


</script>
</html>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap');

    body{
        background-color: #262B3C;

        font-family: "Jost", sans-serif;
        font-optical-sizing: auto;
        font-weight: bolder;
        font-style: normal;

        background-color: black;
    }

    ::placeholder {
        color: #5A33C8;
        font-weight: bold;
    }

    .btn{
        background-color: #262E4A;
    }

    .btnTxt{
        color: #5A33C8;
    }

    .btn:hover{
        background-color: #5A33C8;

        .btnTxt{
            color: #262E4A;
        }
    }
    

    .input-container {
        position: relative;
        width: 450px; /* Match the width of the input */
    }
    .suggestions-list {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    border: 1px solid #5A33C8;
    background: #262E4A;
    list-style: none;
    margin: 0;
    padding: 0;
    display: none;
    z-index: 1000;
    border-radius: 0 0 20px 20px;
    overflow-y: auto; /* Enable vertical scrolling */
    max-height: 100px; /* Set a maximum height */
    scrollbar-width: thin; /* For Firefox */
    scrollbar-color: #5A33C8 #262E4A; /* For Firefox */
}

/* Styling for Webkit browsers (Chrome, Safari, etc.) */
.suggestions-list::-webkit-scrollbar {
    width: 8px;
}

.suggestions-list::-webkit-scrollbar-track {
    background: #262E4A;
}

.suggestions-list::-webkit-scrollbar-thumb {
    background-color: #5A33C8;
    border-radius: 4px;
}

.suggestions-list li {
    padding: 8px 20px;
    cursor: pointer;
    color: #5A33C8;
}

.suggestions-list li:hover {
    background: #323a5c;
}
.arrow{
    color: #8D65FF;
    cursor: pointer;
    opacity: 0.5;
}
.arrow:hover{
    opacity: 0.8;
}

.infoBtn:hover{
    opacity: 0.6;
    cursor: pointer;
}


/* .movieInp{
    width: 450px;
}

@media screen and (max-width: 610px) {

    .input-container{
        width: 300px;
    }

    .movieInp{
        width: 300px;
    }

} */
</style>